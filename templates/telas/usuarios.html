{% extends '_layouts.html' %}

{% block content %}
<html lang="pt-br" class="dark"></html>
  <head>
    <meta charset="utf-8" />
    <title>Usuários | Biblioteca Digital</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  </head>
  <body class="font-display bg-background-light dark:bg-background-dark text-gray-900 dark:text-gray-100">
    <div class="container mx-auto p-6">
      <h1 class="text-3xl font-bold mb-6 text-center">Gerenciar Usuários</h1>

      {% if mensagem %}
      <div class="mb-6 p-4 rounded-lg 
                  {% if 'sucesso' in mensagem|lower %} bg-green-600 
                  {% else %} bg-red-600 {% endif %}
                  text-white text-center font-medium">
        {{ mensagem }}
      </div>
      {% endif %}

      <table class="w-full border border-gray-300 dark:border-gray-700 rounded-lg overflow-hidden">
        <thead class="bg-gray-100 dark:bg-gray-800">
          <tr>
            <th class="p-3 text-left">Nome</th>
            <th class="p-3 text-left">E-mail</th>
            <th class="p-3 text-center">Status</th>
            <th class="p-3 text-center">Ação</th>
          </tr>
        </thead>
        <tbody>
          {% for nome, email, bloqueado in usuarios %}
          <tr class="border-t border-gray-200 dark:border-gray-700">
            <td class="p-3">{{ nome }}</td>
            <td class="p-3">{{ email }}</td>
            <td class="p-3 text-center">
              {% if bloqueado == 'S' %}
                <span class="text-red-600 font-semibold">Bloqueado</span>
              {% else %}
                <span class="text-green-600 font-semibold">Ativo</span>
              {% endif %}
            </td>
            <td class="p-3 text-center">
              {% if bloqueado == 'S' %}
              <form method="post" action="{% url 'usuarios' %}">
                {% csrf_token %}
                <input type="hidden" name="email" value="{{ email }}">
                <button
                  type="submit"
                  class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                  Desbloquear
                </button>
              </form>
              {% else %}
              <span class="text-gray-500">—</span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

    </div>
  </body>
</html>
{% endblock content %}
